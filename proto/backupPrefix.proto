syntax = "proto3";

import "C14Cipher.proto";
import "C15IV.proto";
import "keyType.proto";
import "backupExpiry.proto";

message BackupPrefix {
    // The "optional" here is to make protobuf serialize the zero as well,
    // otherwise, being the default for numeric, it would be omitted.
    optional Key_Type key_type = 1; // 0 if traditional (crypt14), 1 if end-to-end (crypt15)
    oneof cipher_info {
        C14cipher c14_cipher = 2; // If DB is crypt14
        C15IV c15_iv = 3; // If DB is crypt15
    }
    // Version that generated backup and other infos
    BackupExpiry info = 4;
}